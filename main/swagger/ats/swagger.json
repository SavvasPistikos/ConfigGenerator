{
	"swagger": "2.0",
	"info": {
		"description": "API specification",
		"version": "1.0",
		"title": "ats-service"
	},
	"tags": [
		{
			"name": "Retrieve document Service"
		},
		{
			"name": "Submit document Service"
		}
	],
	"schemes": [
		"http"
	],
	"paths": {
		"/api/v1.0/ats/documents/documentHash": {
			"get": {
				"tags": [
					"Retrieve document Service"
				],
				"summary": "ATS will use this in order to instruct the server to create a document and generate its hash value for verification purposes.",
				"description": "",
				"operationId": "retrieveDocument",
				"produces": [
					"application/json"
				],
				"parameters": [
					{
						"name": "X-OECID",
						"in": "header",
						"description": "Execution Context ID Header. Will be received and must be used when logging and the same should be send back with the response in order to be able to correlate logs within the same context",
						"required": true,
						"type": "string"
					},
					{
						"name": "Authorization",
						"in": "header",
						"description": "Used to authenticate the caller. In the format of Authorization Bearer <Pre-Shared Access Token generated by the Gaming System>",
						"required": true,
						"type": "string"
					},
					{
						"name": "X-Auth-System-ID",
						"in": "header",
						"description": "Provided by the Gaming System and Identifies connecting System.",
						"required": false,
						"type": "integer",
						"format": "int32"
					},
					{
						"name": "systemId",
						"in": "query",
						"description": "The systemId from which to get the hash.",
						"required": true,
						"type": "integer",
						"format": "int32"
					},
					{
						"name": "documentTypeId",
						"in": "query",
						"description": "The document type id from which to get the hash.",
						"required": true,
						"type": "integer",
						"format": "int32",
						"enum": [
							1,
							2
						]
					},
					{
						"name": "documentId",
						"in": "query",
						"description": "The documentId from which to get the hash.",
						"required": true,
						"type": "string"
					}
				],
				"responses": {
					"200": {
						"description": "Success",
						"schema": {
							"$ref": "#/definitions/AtsRetrieveDocumentResponseDto"
						},
						"responseSchema": {
							"$ref": "#/definitions/AtsRetrieveDocumentResponseDto"
						}
					},
					"401": {
						"description": "Unauthorized Error",
						"headers": {
							"WWW_Authenticate": {
								"type": "string",
								"description": "UnauthorizedError"
							}
						}
					},
					"400": {
						"description": "Business Fault (e.g. Error talking to the Gaming System)",
						"headers": {
							"X-OECID": {
								"type": "string",
								"description": "This is the same value as given in the request"
							}
						},
						"schema": {
							"$ref": "#/definitions/AtsOpapErrorInfo"
						},
						"responseSchema": {
							"$ref": "#/definitions/AtsOpapErrorInfo"
						}
					},
					"404": {
						"description": "Document Not Found",
						"headers": {
							"X-OECID": {
								"type": "string",
								"description": "This is the same value as given in the request"
							}
						},
						"schema": {
							"type": "string"
						},
						"responseSchema": {
							"type": "string"
						}
					},
					"500": {
						"description": "Runtime Fault",
						"headers": {
							"X-OECID": {
								"type": "string",
								"description": "This is the same value as given in the request"
							}
						},
						"schema": {
							"$ref": "#/definitions/AtsOpapErrorInfo"
						},
						"responseSchema": {
							"$ref": "#/definitions/AtsOpapErrorInfo"
						}
					}
				}
			},
			"post": {
				"tags": [
					"Retrieve document Service"
				],
				"summary": "ATS will use this in order to instruct the server to create the hashes if documents for a specified date time period for verification purposes. The response could be synchronous if the System can generate the list in \"real time\" or asynchronous. If asynchronous an id is returned in order for the ATS to poll for the data.",
				"description": "",
				"operationId": "retrieveDocuments",
				"consumes": [
					"application/json"
				],
				"produces": [
					"application/json"
				],
				"parameters": [
					{
						"name": "X-OECID",
						"in": "header",
						"description": "Execution Context ID Header. Will be received and must be used when logging and the same should be send back with the response in order to be able to correlate logs within the same context",
						"required": true,
						"type": "string"
					},
					{
						"name": "Authorization",
						"in": "header",
						"description": "Used to authenticate the caller. In the format of Authorization Bearer <Pre-Shared Access Token generated by the Gaming System>",
						"required": true,
						"type": "string"
					},
					{
						"name": "X-Auth-System-ID",
						"in": "header",
						"description": "Provided by the Gaming System and Identifies connecting System.",
						"required": false,
						"type": "integer",
						"format": "int32"
					},
					{
						"in": "body",
						"name": "body",
						"description": "The submit document request from L5",
						"required": true,
						"schema": {
							"$ref": "#/definitions/AtsRetrieveDocumentsRequestDto"
						}
					}
				],
				"responses": {
					"202": {
						"description": "Accepted. The server has started creating the report.",
						"schema": {
							"$ref": "#/definitions/AtsRetrieveDocumentsResponseDto"
						},
						"responseSchema": {
							"$ref": "#/definitions/AtsRetrieveDocumentsResponseDto"
						}
					},
					"401": {
						"description": "Unauthorized Error",
						"headers": {
							"WWW_Authenticate": {
								"type": "string",
								"description": "UnauthorizedError"
							}
						}
					},
					"400": {
						"description": "Business Fault (e.g. Error talking to the Gaming System)",
						"headers": {
							"X-OECID": {
								"type": "string",
								"description": "This is the same value as given in the request"
							}
						},
						"schema": {
							"$ref": "#/definitions/AtsOpapErrorInfo"
						},
						"responseSchema": {
							"$ref": "#/definitions/AtsOpapErrorInfo"
						}
					},
					"404": {
						"description": "Document Not Found",
						"headers": {
							"X-OECID": {
								"type": "string",
								"description": "This is the same value as given in the request"
							}
						},
						"schema": {
							"type": "string"
						},
						"responseSchema": {
							"type": "string"
						}
					},
					"500": {
						"description": "Runtime Fault",
						"headers": {
							"X-OECID": {
								"type": "string",
								"description": "This is the same value as given in the request"
							}
						},
						"schema": {
							"$ref": "#/definitions/AtsOpapErrorInfo"
						},
						"responseSchema": {
							"$ref": "#/definitions/AtsOpapErrorInfo"
						}
					}
				}
			}
		},
		"/api/v1.0/ats/documents/documentHash/{id}": {
			"get": {
				"tags": [
					"Retrieve document Service"
				],
				"summary": "Get the report or status of it if not finished",
				"description": "Get the report or status of it if not finished",
				"operationId": "polling",
				"consumes": [
					"application/json"
				],
				"produces": [
					"application/json"
				],
				"parameters": [
					{
						"name": "X-OECID",
						"in": "header",
						"description": "Execution Context ID Header. Will be received and must be used when logging and the same should be send back with the response in order to be able to correlate logs within the same context",
						"required": true,
						"type": "string"
					},
					{
						"name": "Authorization",
						"in": "header",
						"description": "Used to authenticate the caller. In the format of Authorization Bearer <Pre-Shared Access Token generated by the Gaming System>",
						"required": true,
						"type": "string"
					},
					{
						"name": "X-Auth-System-ID",
						"in": "header",
						"description": "Provided by the Gaming System and Identifies connecting System.",
						"required": false,
						"type": "integer",
						"format": "int32"
					},
					{
						"name": "id",
						"in": "path",
						"description": "The submitted report id",
						"required": true,
						"type": "integer",
						"format": "int64"
					}
				],
				"responses": {
					"200": {
						"description": "Report Created",
						"headers": {
							"X-OECID": {
								"type": "string",
								"description": "This is the same value as given in the request"
							}
						},
						"schema": {
							"$ref": "#/definitions/RetrieveDocumentsStatusCompleteDto"
						},
						"responseSchema": {
							"$ref": "#/definitions/RetrieveDocumentsStatusCompleteDto"
						}
					},
					"202": {
						"description": "Accepted. The server is working on creating the data.",
						"headers": {
							"X-OECID": {
								"type": "string",
								"description": "This is the same value as given in the request"
							}
						},
						"schema": {
							"$ref": "#/definitions/RetrieveDocumentsStatusPendingDto"
						},
						"responseSchema": {
							"$ref": "#/definitions/RetrieveDocumentsStatusPendingDto"
						}
					},
					"401": {
						"description": "Unauthorized Error",
						"headers": {
							"WWW_Authenticate": {
								"type": "string",
								"description": "UnauthorizedError"
							}
						}
					},
					"400": {
						"description": "Business Fault (e.g. Error talking to the Gaming System)",
						"headers": {
							"X-OECID": {
								"type": "string",
								"description": "This is the same value as given in the request"
							}
						},
						"schema": {
							"$ref": "#/definitions/AtsOpapErrorInfo"
						},
						"responseSchema": {
							"$ref": "#/definitions/AtsOpapErrorInfo"
						}
					},
					"404": {
						"description": "Document Not Found",
						"headers": {
							"X-OECID": {
								"type": "string",
								"description": "This is the same value as given in the request"
							}
						},
						"schema": {
							"type": "string"
						},
						"responseSchema": {
							"type": "string"
						}
					},
					"500": {
						"description": "Runtime Fault",
						"headers": {
							"X-OECID": {
								"type": "string",
								"description": "This is the same value as given in the request"
							}
						},
						"schema": {
							"$ref": "#/definitions/AtsOpapErrorInfo"
						},
						"responseSchema": {
							"$ref": "#/definitions/AtsOpapErrorInfo"
						}
					}
				}
			},
			"put": {
				"tags": [
					"Retrieve document Service"
				],
				"summary": "Consumes ftp paths for given gameId and draws from L5.",
				"description": "Consumes ftp paths for given gameId and draws from L5.",
				"operationId": "updateDocuments",
				"consumes": [
					"application/json"
				],
				"produces": [
					"application/json"
				],
				"parameters": [
					{
						"name": "id",
						"in": "path",
						"description": "The submitted report id",
						"required": true,
						"type": "integer",
						"format": "int64"
					},
					{
						"in": "body",
						"name": "body",
						"description": "L5 Retrieve Document when complete",
						"required": true,
						"schema": {
							"$ref": "#/definitions/UpdateDocumentsRequest"
						}
					}
				],
				"responses": {
					"200": {
						"description": "OK",
						"schema": {
							"type": "string"
						},
						"responseSchema": {
							"type": "string"
						}
					},
					"400": {
						"description": "VALIDATION ERROR",
						"schema": {
							"$ref": "#/definitions/AtsOpapErrorInfo"
						},
						"responseSchema": {
							"$ref": "#/definitions/AtsOpapErrorInfo"
						}
					},
					"404": {
						"description": "VALIDATION ERROR",
						"schema": {
							"$ref": "#/definitions/AtsOpapErrorInfo"
						},
						"responseSchema": {
							"$ref": "#/definitions/AtsOpapErrorInfo"
						}
					},
					"500": {
						"description": "APPLICATION ERROR",
						"schema": {
							"$ref": "#/definitions/AtsOpapErrorInfo"
						},
						"responseSchema": {
							"$ref": "#/definitions/AtsOpapErrorInfo"
						}
					},
					"502": {
						"description": "BAD GATEWAY"
					},
					"503": {
						"description": "SERVICE UNAVAILABLE"
					}
				}
			}
		},
		"/api/v1.0/submit": {
			"post": {
				"tags": [
					"Submit document Service"
				],
				"summary": "Submits a document generated from L5.",
				"description": "Submits a document generated from L5.",
				"operationId": "submitDocument",
				"consumes": [
					"application/json"
				],
				"produces": [
					"application/json"
				],
				"parameters": [
					{
						"in": "body",
						"name": "body",
						"description": "The submit document request from L5",
						"required": true,
						"schema": {
							"$ref": "#/definitions/SubmitDocumentRequestDto"
						}
					}
				],
				"responses": {
					"200": {
						"description": "Success",
						"schema": {
							"type": "string"
						},
						"responseSchema": {
							"type": "string"
						}
					},
					"500": {
						"description": "Runtime Fault",
						"schema": {
							"$ref": "#/definitions/FaultInfo"
						},
						"responseSchema": {
							"$ref": "#/definitions/FaultInfo"
						}
					}
				}
			}
		},
		"/api/v1.0/submit/replay/{id}": {
			"post": {
				"tags": [
					"Submit document Service"
				],
				"summary": "Replays a document submission that was already been submitted from L5 but failed during the execution within ats-service.",
				"description": "Replays a document submission that was already been submitted from L5 but failed during the execution within ats-service.",
				"operationId": "replaySubmission",
				"consumes": [
					"application/json"
				],
				"produces": [
					"application/json"
				],
				"parameters": [
					{
						"name": "id",
						"in": "path",
						"description": "The id of the submission",
						"required": true,
						"type": "integer",
						"format": "int64"
					}
				],
				"responses": {
					"200": {
						"description": "Success",
						"schema": {
							"type": "string"
						},
						"responseSchema": {
							"type": "string"
						}
					},
					"500": {
						"description": "Runtime Fault",
						"schema": {
							"$ref": "#/definitions/FaultInfo"
						},
						"responseSchema": {
							"$ref": "#/definitions/FaultInfo"
						}
					}
				}
			}
		},
		"/api/v1.0/submit/history": {
			"get": {
				"tags": [
					"Submit document Service"
				],
				"summary": "Retrieves the history of submit document operation.",
				"description": "Retrieves the history of submit document operation.",
				"operationId": "retrieveSubmitDocumentHistory",
				"produces": [
					"application/json"
				],
				"parameters": [
					{
						"name": "gameId",
						"in": "query",
						"description": "The Game Id",
						"required": true,
						"type": "integer",
						"format": "int32"
					},
					{
						"name": "drawId",
						"in": "query",
						"description": "The Draw Id",
						"required": true,
						"type": "integer",
						"format": "int32"
					},
					{
						"name": "authorization",
						"in": "header",
						"description": "The authorization",
						"required": false,
						"type": "string"
					},
					{
						"name": "guid",
						"in": "header",
						"description": "The globally unique identifier",
						"required": false,
						"type": "string"
					}
				],
				"responses": {
					"200": {
						"description": "Success",
						"schema": {
							"type": "array",
							"items": {
								"$ref": "#/definitions/SubmitDocumentRequestHistory"
							}
						},
						"responseSchema": {
							"type": "array",
							"items": {
								"$ref": "#/definitions/SubmitDocumentRequestHistory"
							}
						}
					},
					"500": {
						"description": "Runtime Fault",
						"schema": {
							"$ref": "#/definitions/FaultInfo"
						},
						"responseSchema": {
							"$ref": "#/definitions/FaultInfo"
						}
					}
				}
			}
		},
		"/api/v1.0/submit/{directory}/{fileName}": {
			"get": {
				"tags": [
					"Submit document Service"
				],
				"summary": "Gets a submitted document stored at L10.",
				"description": "Gets a submitted document stored at L10.",
				"operationId": "getDocument",
				"produces": [
					"application/zip",
					"application/octet-stream"
				],
				"parameters": [
					{
						"name": "directory",
						"in": "path",
						"description": "The relative path of the document",
						"required": true,
						"type": "string"
					},
					{
						"name": "fileName",
						"in": "path",
						"description": "The file name of the document",
						"required": true,
						"type": "string"
					}
				],
				"responses": {
					"200": {
						"description": "Success",
						"schema": {
							"type": "string"
						},
						"responseSchema": {
							"type": "string"
						}
					},
					"500": {
						"description": "Runtime Fault",
						"schema": {
							"$ref": "#/definitions/FaultInfo"
						},
						"responseSchema": {
							"$ref": "#/definitions/FaultInfo"
						}
					}
				}
			}
		}
	},
	"definitions": {
		"AtsRetrieveDocumentResponseDto": {
			"type": "object",
			"required": [
				"documentDate",
				"documentId",
				"documentSchemaVersion",
				"documentTypeId",
				"hash",
				"hashCreationTimeStamp",
				"systemId"
			],
			"properties": {
				"systemId": {
					"type": "integer",
					"format": "int32",
					"example": 0,
					"description": "System Id identifier"
				},
				"documentTypeId": {
					"type": "integer",
					"format": "int32",
					"example": 1,
					"description": "Document Type Id"
				},
				"documentId": {
					"type": "string",
					"example": "string",
					"description": "Document Id"
				},
				"documentSchemaVersion": {
					"type": "integer",
					"format": "int32",
					"example": 0,
					"description": "The Schema Version of the Document and Hash generated"
				},
				"hash": {
					"type": "string",
					"example": "string",
					"description": "The hash of the document as it is now in the system"
				},
				"hashCreationTimeStamp": {
					"type": "string",
					"example": "2018-07-06T07:20:45.486Z",
					"description": "The timestamp in UTC the hash was generated in the system. (Since this asynchronous the datetime that the hash as produced is returned)"
				},
				"documentDate": {
					"type": "string",
					"example": "2018-07-06T07:20:45.486Z",
					"description": "The creation timestamp in UTC of the document as it is now in the system"
				}
			}
		},
		"AtsOpapErrorInfo": {
			"type": "object",
			"properties": {
				"errorCode": {
					"type": "integer",
					"format": "int32"
				},
				"errorMsg": {
					"type": "string"
				}
			}
		},
		"AtsRetrieveDocumentsResponseDto": {
			"type": "object",
			"properties": {
				"id": {
					"type": "integer",
					"format": "int64"
				},
				"msg": {
					"type": "string"
				}
			}
		},
		"AtsRetrieveDocumentsRequestDto": {
			"type": "object",
			"required": [
				"documentTypeId",
				"fromDatetime",
				"systemId",
				"toDatetime"
			],
			"properties": {
				"systemId": {
					"type": "integer",
					"format": "int32",
					"example": 5,
					"description": "systemId"
				},
				"documentTypeId": {
					"type": "integer",
					"format": "int32",
					"example": 1,
					"description": "documentTypeId"
				},
				"fromDatetime": {
					"type": "string",
					"format": "date-time",
					"example": "2018-06-18T13:00:00.000Z",
					"description": "The from date time in UTC"
				},
				"toDatetime": {
					"type": "string",
					"format": "date-time",
					"example": "2018-06-18T14:00:00.000Z",
					"description": "The to date time in UTC"
				}
			},
			"description": "Documents Hash creation and retrieval"
		},
		"DocumentHashesDto": {
			"type": "object",
			"required": [
				"documentDate",
				"documentId",
				"documentSchemaVersion",
				"documentTypeId",
				"hash",
				"hashCreationTimeStamp",
				"systemId"
			],
			"properties": {
				"systemId": {
					"type": "integer",
					"format": "int32",
					"example": 1100,
					"description": "systemId"
				},
				"documentTypeId": {
					"type": "integer",
					"format": "int32",
					"example": 1,
					"description": "documentTypeId"
				},
				"documentId": {
					"type": "string",
					"example": "1100-1",
					"description": "1"
				},
				"documentSchemaVersion": {
					"type": "integer",
					"format": "int32",
					"example": 1,
					"description": "The document schema version"
				},
				"hash": {
					"type": "string",
					"example": "1",
					"description": "The document hash"
				},
				"hashCreationTimeStamp": {
					"type": "string",
					"example": "2018-06-28T12:04:16.832Z",
					"description": "The date that hash was created"
				},
				"documentDate": {
					"type": "string",
					"example": "2018-06-28T12:04:16.832Z",
					"description": "The document date"
				}
			},
			"description": "The document hashes"
		},
		"RetrieveDocumentsStatusCompleteDto": {
			"type": "object",
			"required": [
				"id"
			],
			"properties": {
				"id": {
					"type": "integer",
					"format": "int64",
					"example": 1,
					"description": "id"
				},
				"documentHashes": {
					"type": "array",
					"description": "Array of document hashed",
					"items": {
						"$ref": "#/definitions/DocumentHashesDto"
					}
				}
			},
			"description": "RetrieveDocumentsStatusCompleteDto"
		},
		"RetrieveDocumentsStatusPendingDto": {
			"type": "object",
			"required": [
				"id"
			],
			"properties": {
				"id": {
					"type": "integer",
					"format": "int64",
					"example": 1,
					"description": "id"
				},
				"status": {
					"type": "string",
					"description": "pending"
				},
				"msg": {
					"type": "string",
					"description": "message for pending"
				}
			},
			"description": "RetrieveDocumentsStatusPendingDto"
		},
		"L5DrawsFilePathDto": {
			"type": "object",
			"required": [
				"draw",
				"filePath",
				"revision",
				"schemaVersion"
			],
			"properties": {
				"draw": {
					"type": "integer",
					"format": "int32",
					"example": 1100,
					"description": "drawId"
				},
				"filePath": {
					"type": "string",
					"example": "/1100/AT_Cpns_1100_684138_rev1.TXT",
					"description": "filePath"
				},
				"schemaVersion": {
					"type": "integer",
					"format": "int32",
					"example": 1,
					"description": "1"
				},
				"revision": {
					"type": "integer",
					"format": "int32",
					"example": 1,
					"description": "1"
				}
			},
			"description": "Array of draws entity"
		},
		"L5Header": {
			"type": "object",
			"required": [
				"game",
				"transactionId"
			],
			"properties": {
				"transactionId": {
					"type": "integer",
					"format": "int64",
					"example": 1,
					"description": "transactionId"
				},
				"game": {
					"type": "integer",
					"format": "int32",
					"example": 1100,
					"description": "game"
				},
				"status": {
					"type": "integer",
					"format": "int32",
					"example": 1,
					"description": "status"
				}
			},
			"description": "L5 Header"
		},
		"UpdateDocumentsRequest": {
			"type": "object",
			"required": [
				"header"
			],
			"properties": {
				"header": {
					"description": "header",
					"$ref": "#/definitions/L5Header"
				},
				"draws": {
					"type": "array",
					"description": "Array of completed draws",
					"items": {
						"$ref": "#/definitions/L5DrawsFilePathDto"
					}
				}
			},
			"description": "L5 Complete Draws Request"
		},
		"FaultInfo": {
			"type": "object",
			"properties": {
				"code": {
					"type": "integer",
					"format": "int32",
					"description": "The error code"
				},
				"message": {
					"type": "string",
					"description": "The error message"
				},
				"data": {
					"type": "array",
					"description": "The error data which is an abstract object that may be used to provide any error metadata",
					"items": {
						"type": "object"
					}
				},
				"source": {
					"type": "string",
					"description": "The application at which the API error occured"
				},
				"type": {
					"type": "string",
					"description": "The error family, e.g. RUNTIME, VALIDATION, etc"
				}
			},
			"description": "The FaultInfo object contains all the details assosiated with an API error"
		},
		"SubmitDocumentRequestDto": {
			"type": "object",
			"required": [
				"drawClosedDate",
				"drawId",
				"ftpPath",
				"gameId",
				"revisionNumber",
				"schemaVersion"
			],
			"properties": {
				"gameId": {
					"type": "integer",
					"format": "int32",
					"example": 1100,
					"description": "The game id"
				},
				"drawId": {
					"type": "integer",
					"format": "int32",
					"example": 684138,
					"description": "The draw id"
				},
				"revisionNumber": {
					"type": "integer",
					"format": "int32",
					"example": 1,
					"description": "The revision number"
				},
				"drawClosedDate": {
					"type": "string",
					"format": "date-time",
					"example": "2018-06-18T13:21:44.000Z",
					"description": "The date the draw closed in UTC"
				},
				"schemaVersion": {
					"type": "integer",
					"format": "int32",
					"example": 1,
					"description": "The Schema version"
				},
				"ftpPath": {
					"type": "string",
					"example": "/1100/AT_Cpns_1100_684138_rev1.TXT",
					"description": "The file path in the FTP server"
				}
			},
			"description": "The SubmitDocumentRequest Request DTO"
		},
		"SubmitDocumentRequestHistory": {
			"type": "object",
			"properties": {
				"id": {
					"type": "integer",
					"format": "int64"
				},
				"requestId": {
					"type": "integer",
					"format": "int64"
				},
				"createdAt": {
					"type": "string",
					"format": "date-time"
				},
				"origin": {
					"type": "string"
				},
				"gameId": {
					"type": "integer",
					"format": "int32"
				},
				"drawId": {
					"type": "integer",
					"format": "int32"
				},
				"revisionNumber": {
					"type": "integer",
					"format": "int32"
				},
				"drawClosedDate": {
					"type": "string",
					"format": "date-time"
				},
				"winnersIncluded": {
					"type": "boolean"
				},
				"schemaVersion": {
					"type": "integer",
					"format": "int32"
				},
				"ftpPath": {
					"type": "string"
				},
				"status": {
					"type": "string"
				},
				"documentHash": {
					"type": "string"
				},
				"l10Path": {
					"type": "string"
				},
				"errorMessage": {
					"type": "string"
				}
			}
		}
	}
}
